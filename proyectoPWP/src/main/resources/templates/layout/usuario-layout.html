<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

    <head th:replace="~{layout/plantilla :: head}"/>

            
            <!-- Layout Fragment -->
            <div class="main-container">
                <!-- Header -->
                <nav class="navbar">
                    <div class="nav-container">
                <div class="d-flex align-items-center">
                    <button class="menu-toggle d-md-none me-2" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <a href="/usuario/dashboard" class="logo">
                        <i class="fas fa-dumbbell"></i>
                        <span>FideGYM</span>
                    </a>
                </div>
                
                <div class="d-none d-md-flex nav-links">
                    <a href="/usuario/dashboard" class="active">
                        <i class="fas fa-home"></i>
                        <span>Inicio</span>
                    </a>
                    <a href="/usuario/clases">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Clases</span>
                    </a>
                    <a href="/usuario/rutinas">
                        <i class="fas fa-dumbbell"></i>
                        <span>Rutinas</span>
                    </a>
                    <a href="/usuario/progreso">
                        <i class="fas fa-chart-line"></i>
                        <span>Progreso</span>
                    </a>
                </div>
                
                <div class="user-menu">
                    <a href="/usuario/notificaciones" class="me-3">
                        <i class="fas fa-bell"></i>
                    </a>
                    <div class="dropdown">
                        <div class="user-avatar" onclick="toggleDropdown()">
                            <span sec:authentication="principal.username" th:text="${#strings.substring(#authentication.principal.username, 0, 1).toUpperCase()}">U</span>
                        </div>
                        <div class="dropdown-menu" id="userDropdown">
                            <a class="dropdown-item" href="/usuario/perfil">
                                <i class="fas fa-user me-2"></i> Mi Perfil
                            </a>
                            <a class="dropdown-item" href="/usuario/ajustes">
                                <i class="fas fa-cog me-2"></i> Ajustes
                            </a>
                            <div class="dropdown-divider"></div>
                            <form th:action="@{/logout}" method="post" class="dropdown-item">
                                <button type="submit" class="btn btn-link p-0 text-danger">
                                    <i class="fas fa-sign-out-alt me-2"></i> Cerrar Sesión
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <ul class="sidebar-menu">
                <li>
                    <a href="/usuario/dashboard" class="active">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="/usuario/clases">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Mis Clases</span>
                    </a>
                </li>
                <li>
                    <a href="/usuario/rutinas">
                        <i class="fas fa-dumbbell"></i>
                        <span>Mis Rutinas</span>
                    </a>
                </li>
                <li>
                    <a href="/usuario/progreso">
                        <i class="fas fa-chart-line"></i>
                        <span>Mi Progreso</span>
                    </a>
                </li>
                <li>
                    <a href="/usuario/medidas">
                        <i class="fas fa-ruler"></i>
                        <span>Medidas</span>
                    </a>
                </li>
                <li>
                    <a href="/usuario/pagos">
                        <i class="fas fa-credit-card"></i>
                        <span>Pagos</span>
                    </a>
                </li>
                <li>
                    <a href="/usuario/ajustes">
                        <i class="fas fa-cog"></i>
                        <span>Ajustes</span>
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title" th:text="${tituloPagina}">Título de la Página</h1>
                <p class="page-subtitle" th:if="${pageSubtitle}" th:text="${pageSubtitle}">Subtítulo de la página</p>
            </div>

            <!-- Page Content -->
            <div th:insert="~{::#content}">
                <th:block th:replace="~{::content}">
                    <!-- Content will be inserted here -->
                </th:block>
            </div>
        </main>
        </div>
                    </div>
                </div>
            </div>
            
            <script>
                // Toggle sidebar on mobile
                function toggleSidebar() {
                    document.body.classList.toggle('sidebar-collapsed');
                }

                // Toggle user dropdown
                function toggleDropdown() {
                    document.getElementById('user-dropdown').classList.toggle('show');
                }

                // Close dropdown when clicking outside
                window.onclick = function(event) {
                    if (!event.target.matches('.user-avatar') && !event.target.closest('.user-avatar')) {
                        var dropdowns = document.getElementsByClassName('dropdown-content');
                        for (var i = 0; i < dropdowns.length; i++) {
                            var openDropdown = dropdowns[i];
                            if (openDropdown.classList.contains('show')) {
                                openDropdown.classList.remove('show');
                            }
                        }
                    }
                }
            </script>
        </div>
    </body>
</html>
